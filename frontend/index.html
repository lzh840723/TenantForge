<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TenantForge 前端控制台</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="config.js"></script>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">TenantForge 控制台</div>
      <div class="muted note">当前后端：<code id="baseNow"></code></div>
      <div class="row" style="margin-top:10px">
        <input id="base" placeholder="https://xxx.up.railway.app" />
        <button class="secondary" id="btnSaveBase">保存</button>
      </div>
      <nav class="nav" id="nav">
        <a href="#auth" data-target="auth" class="active">认证</a>
        <a href="#projects" data-target="projects">项目</a>
        <a href="#tasks" data-target="tasks">任务</a>
        <a href="#time" data-target="time">工时</a>
        <a href="#reports" data-target="reports">报表</a>
        <a href="#health" data-target="health">健康检查</a>
      </nav>
      <div class="footer">JWT: <code id="tokenInfo"></code></div>
    </aside>
    <main class="content">
      <section id="auth" class="card">
        <h1>认证</h1>
        <div class="toolbar">
          <button id="btnRefresh">刷新令牌</button>
          <button class="secondary" id="btnLogout">退出登录</button>
          <button class="ghost" id="btnCopyAccess">复制 Access</button>
        </div>
        <h2 style="margin-top:10px">注册</h2>
        <div class="grid two">
          <input id="tenantName" placeholder="Tenant Name" value="demo-tenant" />
          <input id="displayName" placeholder="Display Name" value="Demo Owner" />
          <input id="email" placeholder="Email" value="demo@tenantforge.dev" />
          <input id="password" type="password" placeholder="Password" value="Password123!" />
        </div>
        <div class="row">
          <button id="registerBtn">注册并登录</button>
        </div>
        <pre id="registerOut" class="note"></pre>
        <h2>登录</h2>
        <div class="row">
          <button id="loginBtn">登录</button>
        </div>
        <pre id="loginOut" class="note"></pre>
        <pre id="authOut" class="note"></pre>
      </section>

      <section id="projects" class="card" hidden>
        <h1>项目</h1>
        <div class="grid three">
          <input id="projQ" placeholder="名称包含 (q)" />
          <button id="projList">列表</button>
          <div></div>
          <input id="projName" placeholder="名称" />
          <input id="projDesc" placeholder="描述" />
          <button id="projCreate">新建</button>
          <input id="projId" placeholder="项目ID" />
          <button id="projGet">查询</button>
          <div class="row">
            <button id="projUpdate" class="secondary">更新</button>
            <button id="projDelete" class="secondary">删除</button>
          </div>
        </div>
        <div id="projTableWrap" class="row"></div>
        <pre id="projectsOut" class="note"></pre>
      </section>

      <section id="tasks" class="card" hidden>
        <h1>任务</h1>
        <div class="grid three">
          <input id="taskQ" placeholder="名称包含 (q)" />
          <input id="taskProjectId" placeholder="项目ID (过滤/创建)" />
          <input id="taskStatus" placeholder="状态 (OPEN/CLOSED)" />
          <button id="taskList">列表</button>
          <input id="taskName" placeholder="名称 (创建/更新)" />
          <button id="taskCreate">新建</button>
          <input id="taskId" placeholder="任务ID" />
          <button id="taskGet">查询</button>
          <div class="row">
            <button id="taskUpdate" class="secondary">更新</button>
            <button id="taskDelete" class="secondary">删除</button>
          </div>
        </div>
        <div id="taskTableWrap" class="row"></div>
        <pre id="tasksOut" class="note"></pre>
      </section>

      <section id="time" class="card" hidden>
        <h1>工时</h1>
        <p class="note muted">默认 userId 使用令牌中的 <code id="userIdDefault"></code></p>
        <div class="grid three">
          <input id="teTaskId" placeholder="任务ID" />
          <input id="teUserId" placeholder="用户ID (可留空)" />
          <input id="teNotes" placeholder="备注 (可空)" />
          <input id="teStart" placeholder="开始ISO (默认现在-1h)" />
          <input id="teEnd" placeholder="结束ISO (默认现在)" />
          <button id="teCreate">新建</button>
          <input id="teId" placeholder="工时ID" />
          <button id="teGet">查询</button>
          <div class="row">
            <button id="teUpdate" class="secondary">更新</button>
            <button id="teDelete" class="secondary">删除</button>
          </div>
          <input id="teFilterStart" placeholder="过滤：开始ISO" />
          <input id="teFilterEnd" placeholder="过滤：结束ISO" />
          <button id="teList">列表</button>
        </div>
        <div id="teTableWrap" class="row"></div>
        <pre id="teOut" class="note"></pre>
      </section>

      <section id="reports" class="card" hidden>
        <h1>报表</h1>
        <div class="grid three">
          <input id="rPeriod" placeholder="week|month (默认 week)" />
          <input id="rProjectId" placeholder="项目ID (可选)" />
          <input id="rUserId" placeholder="用户ID (可选)" />
          <button id="rJson">JSON</button>
          <button id="rCsv" class="secondary">CSV</button>
        </div>
        <pre id="reportOut" class="note"></pre>
      </section>

      <section id="health" class="card" hidden>
        <h1>健康检查</h1>
        <div class="toolbar">
          <button id="btnHealth">检查 /api/health</button>
          <a class="secondary" id="linkOpenApi" target="_blank" rel="noreferrer">打开 OpenAPI JSON</a>
        </div>
        <pre id="healthOut" class="note"></pre>
      </section>

      <div id="toast" class="toast"></div>
    </main>
  </div>
  <script src="app.js"></script>
</body>
</html>
